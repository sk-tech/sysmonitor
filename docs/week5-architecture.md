# Week 5 Multi-Host Dashboard Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MULTI-HOST MONITORING SYSTEM                     â”‚
â”‚                              (Week 5 - v0.5.0)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Monitored Host  â”‚         â”‚  Monitored Host  â”‚         â”‚  Monitored Host  â”‚
â”‚   web-server-01  â”‚         â”‚   db-server-01   â”‚         â”‚  app-server-01   â”‚
â”‚                  â”‚         â”‚                  â”‚         â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  sysmond   â”‚  â”‚         â”‚  â”‚  sysmond   â”‚  â”‚         â”‚  â”‚  sysmond   â”‚  â”‚
â”‚  â”‚   (agent)  â”‚  â”‚         â”‚  â”‚   (agent)  â”‚  â”‚         â”‚  â”‚   (agent)  â”‚  â”‚
â”‚  â”‚            â”‚  â”‚         â”‚  â”‚            â”‚  â”‚         â”‚  â”‚            â”‚  â”‚
â”‚  â”‚ Collect:   â”‚  â”‚         â”‚  â”‚ Collect:   â”‚  â”‚         â”‚  â”‚ Collect:   â”‚  â”‚
â”‚  â”‚ â€¢ CPU      â”‚  â”‚         â”‚  â”‚ â€¢ CPU      â”‚  â”‚         â”‚  â”‚ â€¢ CPU      â”‚  â”‚
â”‚  â”‚ â€¢ Memory   â”‚  â”‚         â”‚  â”‚ â€¢ Memory   â”‚  â”‚         â”‚  â”‚ â€¢ Memory   â”‚  â”‚
â”‚  â”‚ â€¢ Disk     â”‚  â”‚         â”‚  â”‚ â€¢ Disk     â”‚  â”‚         â”‚  â”‚ â€¢ Disk     â”‚  â”‚
â”‚  â”‚ â€¢ Network  â”‚  â”‚         â”‚  â”‚ â€¢ Network  â”‚  â”‚         â”‚  â”‚ â€¢ Network  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚         â”‚         â”‚        â”‚         â”‚         â”‚        â”‚         â”‚
â”‚   HTTP POST      â”‚         â”‚   HTTP POST      â”‚         â”‚   HTTP POST      â”‚
â”‚   Every 10s      â”‚         â”‚   Every 10s      â”‚         â”‚   Every 10s      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚                            â”‚
         â”‚                            â”‚                            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              AGGREGATOR SERVER (Port 9000)                 â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  HTTP API Endpoints                                  â”‚ â”‚
         â”‚  â”‚                                                      â”‚ â”‚
         â”‚  â”‚  POST /api/metrics        (Receive from agents)     â”‚ â”‚
         â”‚  â”‚  GET  /api/hosts          (List all hosts)          â”‚ â”‚
         â”‚  â”‚  GET  /api/latest?host=X  (Latest metrics)          â”‚ â”‚
         â”‚  â”‚  GET  /api/fleet/summary  (Fleet statistics)        â”‚ â”‚
         â”‚  â”‚  GET  /                   (Serve dashboard)          â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  SQLite Database (~/.sysmon/aggregator.db)          â”‚ â”‚
         â”‚  â”‚                                                      â”‚ â”‚
         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
         â”‚  â”‚  â”‚ hosts          â”‚      â”‚ metrics              â”‚  â”‚ â”‚
         â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
         â”‚  â”‚  â”‚ hostname (PK)  â”‚      â”‚ timestamp            â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ first_seen     â”‚      â”‚ metric_type          â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ last_seen      â”‚      â”‚ host (FK)            â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ tags (JSON)    â”‚      â”‚ tags                 â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ version        â”‚      â”‚ value                â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ platform       â”‚      â”‚                      â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚ status         â”‚      â”‚ (composite PK)       â”‚  â”‚ â”‚
         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                            HTTP GET (Poll)
                            Every 5 seconds
                                  â”‚
                                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          WEB BROWSER (Multi-Host Dashboard)                â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  FLEET OVERVIEW                                      â”‚ â”‚
         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
         â”‚  â”‚  â”‚ Total:  3â”‚ â”‚ Online:3â”‚ â”‚ Avg CPU  â”‚ â”‚ Total   â”‚â”‚ â”‚
         â”‚  â”‚  â”‚  Hosts   â”‚ â”‚ ğŸŸ¢      â”‚ â”‚ 25.4%    â”‚ â”‚ Memory  â”‚â”‚ â”‚
         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  HOST SELECTOR                                       â”‚ â”‚
         â”‚  â”‚  [ğŸŸ¢ web-server-01 (Linux) â–¼]  [Single] [Compare]   â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  SINGLE HOST VIEW (web-server-01)                    â”‚ â”‚
         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
         â”‚  â”‚  â”‚ CPU      â”‚ â”‚ Memory   â”‚ â”‚ Load Avg â”‚ â”‚ Memory  â”‚â”‚ â”‚
         â”‚  â”‚  â”‚ 34.5%    â”‚ â”‚ 67.2%    â”‚ â”‚ 1.45     â”‚ â”‚ 2.1 GB  â”‚â”‚ â”‚
         â”‚  â”‚  â”‚ â–² 2.3%   â”‚ â”‚ â–¼ 1.1%   â”‚ â”‚ â–² 0.12   â”‚ â”‚ â–² 50 MB â”‚â”‚ â”‚
         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
         â”‚  â”‚                                                      â”‚ â”‚
         â”‚  â”‚  CPU & Memory Trends (Last 5 Minutes)               â”‚ â”‚
         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
         â”‚  â”‚  â”‚ 100%â”€                        CPU â”€â”€           â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚      â•²                      Memory â”€â”€         â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚  75% â”€â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚        â•²        â•±â•²                            â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚  50% â”€â”€â”€â•²â”€â”€â”€â”€â”€â”€â•±â”€â”€â•²â”€â”€â”€â”€â”€                      â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚          â•²    â•±    â•²   â•±                      â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚  25% â”€â”€â”€â”€â”€â•²â”€â”€â•±â”€â”€â”€â”€â”€â”€â•²â”€â•±                       â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚            â•²â•±                                  â”‚  â”‚ â”‚
         â”‚  â”‚  â”‚   0% â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚  â”‚ â”‚
         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                            â”‚
         â”‚  OR                                                        â”‚
         â”‚                                                            â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  COMPARISON VIEW                                     â”‚ â”‚
         â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
         â”‚  â”‚  â”‚ ğŸŸ¢ web-01   â”‚ â”‚ ğŸŸ¢ db-01    â”‚ â”‚ ğŸŸ¢ app-01   â”‚   â”‚ â”‚
         â”‚  â”‚  â”‚ CPU:  34.5% â”‚ â”‚ CPU:  12.3% â”‚ â”‚ CPU:  45.6% â”‚   â”‚ â”‚
         â”‚  â”‚  â”‚ Mem:  67.2% â”‚ â”‚ Mem:  89.1% â”‚ â”‚ Mem:  54.2% â”‚   â”‚ â”‚
         â”‚  â”‚  â”‚ Load: 1.45  â”‚ â”‚ Load: 2.34  â”‚ â”‚ Load: 0.89  â”‚   â”‚ â”‚
         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Sequence

```
1. Agent Collection (Every 2 seconds)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ sysmond  â”‚
   â”‚  (agent) â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚ Collect metrics from OS
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Platform Layer       â”‚
   â”‚ â€¢ Linux: /proc/stat  â”‚
   â”‚ â€¢ Read CPU, Memory   â”‚
   â”‚ â€¢ Parse /proc files  â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ MetricsCollector     â”‚
   â”‚ â€¢ Batch metrics      â”‚
   â”‚ â€¢ Store locally      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
        
2. Agent Push (Every 10 seconds)
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ NetworkPublisher     â”‚
   â”‚ â€¢ Read from DB       â”‚
   â”‚ â€¢ Format JSON        â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ HTTP POST
        â”‚ /api/metrics
        â”‚ {hostname, metrics[]}
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Aggregator Server    â”‚
   â”‚ â€¢ Validate token     â”‚
   â”‚ â€¢ Register host      â”‚
   â”‚ â€¢ Store metrics      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SQLite Database      â”‚
   â”‚ â€¢ Insert metrics     â”‚
   â”‚ â€¢ Update last_seen   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   
3. Dashboard Query (Every 5 seconds)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Browser JavaScript   â”‚
   â”‚ â€¢ Fetch fleet stats  â”‚
   â”‚ â€¢ Fetch host list    â”‚
   â”‚ â€¢ Fetch metrics      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ HTTP GET
        â”‚ /api/fleet/summary
        â”‚ /api/hosts
        â”‚ /api/latest?host=X
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Aggregator Server    â”‚
   â”‚ â€¢ Query SQLite       â”‚
   â”‚ â€¢ Aggregate stats    â”‚
   â”‚ â€¢ Return JSON        â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Browser JavaScript   â”‚
   â”‚ â€¢ Update DOM         â”‚
   â”‚ â€¢ Redraw chart       â”‚
   â”‚ â€¢ Show changes       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Fleet Summary Calculation

```sql
-- Total hosts
SELECT COUNT(*) FROM hosts;

-- Online hosts (last 5 minutes)
SELECT COUNT(*) 
FROM hosts 
WHERE last_seen > (current_timestamp - 300);

-- Average CPU across all online hosts
SELECT AVG(value) FROM (
    SELECT m.value 
    FROM metrics m
    INNER JOIN hosts h ON m.host = h.hostname
    INNER JOIN (
        SELECT host, MAX(timestamp) as max_ts
        FROM metrics
        WHERE metric_type = 'cpu.total_usage'
        GROUP BY host
    ) latest ON m.host = latest.host 
            AND m.timestamp = latest.max_ts
    WHERE h.last_seen > (current_timestamp - 300)
      AND m.metric_type = 'cpu.total_usage'
);

-- Total memory used across all online hosts
SELECT SUM(value) FROM (
    SELECT m.value 
    FROM metrics m
    INNER JOIN hosts h ON m.host = h.hostname
    INNER JOIN (
        SELECT host, MAX(timestamp) as max_ts
        FROM metrics
        WHERE metric_type = 'memory.used_bytes'
        GROUP BY host
    ) latest ON m.host = latest.host 
            AND m.timestamp = latest.max_ts
    WHERE h.last_seen > (current_timestamp - 300)
      AND m.metric_type = 'memory.used_bytes'
);
```

## Component Responsibilities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AGENT (sysmond in agent mode)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Collect system metrics (CPU, memory, disk, network)  â”‚
â”‚ â€¢ Store metrics locally (SQLite)                       â”‚
â”‚ â€¢ Push metrics to aggregator (HTTP POST)               â”‚
â”‚ â€¢ Retry on network failure                             â”‚
â”‚ â€¢ Tag metrics with hostname and custom tags            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AGGREGATOR (Python HTTP server)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Receive metrics from agents (POST /api/metrics)      â”‚
â”‚ â€¢ Store in centralized database                        â”‚
â”‚ â€¢ Track host registration and heartbeats               â”‚
â”‚ â€¢ Serve multi-host dashboard HTML                      â”‚
â”‚ â€¢ Provide query API for dashboard                      â”‚
â”‚ â€¢ Calculate fleet-wide aggregated statistics           â”‚
â”‚ â€¢ Authenticate agents with token                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DASHBOARD (HTML/CSS/JavaScript)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Display fleet overview (total, online, avg CPU, etc) â”‚
â”‚ â€¢ List all registered hosts                            â”‚
â”‚ â€¢ Show single host detailed view with charts           â”‚
â”‚ â€¢ Compare multiple hosts side-by-side                  â”‚
â”‚ â€¢ Auto-refresh every 5 seconds                         â”‚
â”‚ â€¢ Responsive design for mobile/desktop                 â”‚
â”‚ â€¢ Zero external dependencies (vanilla JS)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Network Protocol

```
Agent â†’ Aggregator (Push Metrics)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

POST /api/metrics HTTP/1.1
Host: aggregator:9000
Content-Type: application/json
X-SysMon-Token: sysmon-secret-token

{
  "hostname": "web-server-01",
  "version": "0.5.0",
  "platform": "Linux",
  "tags": {
    "environment": "production",
    "datacenter": "us-east-1",
    "role": "web-server"
  },
  "metrics": [
    {
      "timestamp": 1675728000,
      "metric_type": "cpu.total_usage",
      "value": 34.5,
      "tags": ""
    },
    {
      "timestamp": 1675728000,
      "metric_type": "memory.usage_percent",
      "value": 67.2,
      "tags": ""
    }
  ]
}

Response:
{
  "status": "success",
  "hostname": "web-server-01",
  "metrics_received": 2,
  "metrics_stored": 2,
  "metrics_failed": 0,
  "timestamp": 1675728001
}


Dashboard â†’ Aggregator (Query Fleet)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GET /api/fleet/summary HTTP/1.1
Host: aggregator:9000

Response:
{
  "total_hosts": 3,
  "online_hosts": 3,
  "offline_hosts": 0,
  "avg_cpu_usage": 30.8,
  "total_memory_used": 8589934592,
  "timestamp": 1675728002
}


Dashboard â†’ Aggregator (Query Host)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GET /api/latest?host=web-server-01 HTTP/1.1
Host: aggregator:9000

Response:
{
  "metrics": [
    {
      "timestamp": 1675728000,
      "metric_type": "cpu.total_usage",
      "host": "web-server-01",
      "tags": "",
      "value": 34.5
    },
    {
      "timestamp": 1675728000,
      "metric_type": "memory.usage_percent",
      "host": "web-server-01",
      "tags": "",
      "value": 67.2
    }
  ],
  "count": 2,
  "timestamp": 1675728002
}
```

## File Structure

```
sysmonitor/
â”œâ”€â”€ python/
â”‚   â””â”€â”€ sysmon/
â”‚       â”œâ”€â”€ aggregator/
â”‚       â”‚   â”œâ”€â”€ server.py          (HTTP endpoints + dashboard serving)
â”‚       â”‚   â””â”€â”€ storage.py         (Database + fleet summary logic)
â”‚       â””â”€â”€ api/
â”‚           â””â”€â”€ dashboard-multi.html (Multi-host UI - 731 lines)
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ start-aggregator.sh        (Launch aggregator server)
â”‚   â”œâ”€â”€ demo-distributed.sh        (Full demo with 3 agents)
â”‚   â”œâ”€â”€ start.sh                   (Enhanced with distributed mode)
â”‚   â””â”€â”€ stop.sh                    (Stop all components)
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ week5-summary.md           (Technical documentation)
    â”œâ”€â”€ week5-quickstart.md        (User guide)
    â”œâ”€â”€ week5-implementation.md    (This file)
    â””â”€â”€ week5-architecture.md      (Architecture diagrams)
```

---

**Version**: 0.5.0  
**Date**: February 6, 2026  
**Status**: âœ… Production Ready
