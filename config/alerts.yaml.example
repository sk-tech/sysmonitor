# SysMonitor Alert Configuration
# This file defines threshold-based alerts and notification channels

# Global alert settings
global:
  # Alert evaluation interval (seconds)
  check_interval: 5
  # Cooldown period between repeated alerts (seconds)
  cooldown: 300
  # Enable/disable alerting system
  enabled: true

# Notification channels
notifications:
  email:
    enabled: false
    smtp_host: smtp.gmail.com
    smtp_port: 587
    smtp_user: your-email@gmail.com
    smtp_password: your-app-password
    from: sysmon@localhost
    to:
      - admin@example.com
      - ops@example.com
    
  webhook:
    enabled: true
    url: http://localhost:9090/webhook/alerts
    method: POST
    headers:
      Content-Type: application/json
      Authorization: Bearer your-token-here
    timeout: 5
  
  log:
    enabled: true
    path: ~/.sysmon/alerts.log
    max_size_mb: 10

# Alert rules
alerts:
  - name: high_cpu_usage
    description: Alert when CPU usage exceeds 80%
    metric: cpu.total_usage
    condition: above
    threshold: 80.0
    duration: 30  # seconds - must exceed threshold for this duration
    severity: warning
    notifications:
      - email
      - webhook
      - log
    
  - name: critical_cpu_usage
    description: Critical alert when CPU usage exceeds 95%
    metric: cpu.total_usage
    condition: above
    threshold: 95.0
    duration: 10
    severity: critical
    notifications:
      - email
      - webhook
      - log
    
  - name: high_memory_usage
    description: Alert when memory usage exceeds 85%
    metric: memory.percent_used
    condition: above
    threshold: 85.0
    duration: 60
    severity: warning
    notifications:
      - webhook
      - log
    
  - name: low_available_memory
    description: Alert when available memory drops below 500MB
    metric: memory.available_bytes
    condition: below
    threshold: 524288000  # 500MB in bytes
    duration: 30
    severity: critical
    notifications:
      - email
      - webhook
      - log
    
  - name: high_process_count
    description: Alert when total process count exceeds 500
    metric: system.process_count
    condition: above
    threshold: 500
    duration: 120
    severity: info
    notifications:
      - log
    
  - name: disk_space_critical
    description: Alert when disk usage exceeds 90%
    metric: disk.percent_used
    condition: above
    threshold: 90.0
    duration: 60
    severity: critical
    notifications:
      - email
      - webhook
      - log

# Process-specific alerts (optional)
process_alerts:
  - name: high_process_cpu
    description: Alert when individual process CPU exceeds 50%
    process_name: "*"  # Wildcard for any process
    metric: process.cpu_percent
    condition: above
    threshold: 50.0
    duration: 60
    severity: warning
    notifications:
      - log
    
  - name: high_process_memory
    description: Alert when individual process memory exceeds 2GB
    process_name: "*"
    metric: process.memory_bytes
    condition: above
    threshold: 2147483648  # 2GB
    duration: 30
    severity: warning
    notifications:
      - log
